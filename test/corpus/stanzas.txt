==========
Executable
==========

(executable
 (name e)
 (public_name p)
 (libraries a b c))

---

(source_file
  (sexp
    (list
      (sexp
        (atom))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (atom))))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (atom))))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (atom))
          (sexp
            (atom))
          (sexp
            (atom)))))))

====
Rule
====

(rule
 (mode promote)
 (alias runtest)
 (targets setup.defaults.ml)
 (deps
  (:configure %{project_root}/boot/configure.ml))
 (action
  (chdir
   %{project_root}
   (setenv
    DUNE_CONFIGURE_OUTPUT
    "src/dune_rules/setup.defaults.ml"
    (run %{ocaml} %{configure})))))

(rule
 (mode promote)
 (target assets.ml)
 (action
  (with-stdout-to
   %{target}
   (progn
    (echo "let jbuild_plugin_ml = {jbp|\n")
    (cat %{project_root}/plugin/jbuild_plugin.ml)
    (echo "|jbp}\n\n")
    (echo "let jbuild_plugin_mli = {jbp|")
    (cat %{project_root}/plugin/jbuild_plugin.mli)
    (echo "|jbp}")))))

---

(source_file
  (sexp
    (list
      (sexp
        (atom))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (atom))))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (atom))))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (atom))))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (list
              (sexp
                (atom))
              (sexp
                (atom))))))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (list
              (sexp
                (atom))
              (sexp
                (atom))
              (sexp
                (list
                  (sexp
                    (atom))
                  (sexp
                    (atom))
                  (sexp
                    (atom))
                  (sexp
                    (list
                      (sexp
                        (atom))
                      (sexp
                        (atom))
                      (sexp
                        (atom))))))))))))
  (sexp
    (list
      (sexp
        (atom))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (atom))))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (atom))))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (list
              (sexp
                (atom))
              (sexp
                (atom))
              (sexp
                (list
                  (sexp
                    (atom))
                  (sexp
                    (list
                      (sexp
                        (atom))
                      (sexp
                        (atom))
                      (sexp
                        (atom))
                      (sexp
                        (atom))
                      (sexp
                        (atom))))
                  (sexp
                    (list
                      (sexp
                        (atom))
                      (sexp
                        (atom))))
                  (sexp
                    (list
                      (sexp
                        (atom))
                      (sexp
                        (atom))))
                  (sexp
                    (list
                      (sexp
                        (atom))
                      (sexp
                        (atom))
                      (sexp
                        (atom))
                      (sexp
                        (atom))
                      (sexp
                        (atom))))
                  (sexp
                    (list
                      (sexp
                        (atom))
                      (sexp
                        (atom))))
                  (sexp
                    (list
                      (sexp
                        (atom))
                      (sexp
                        (atom)))))))))))))

=======
Library
=======

(library
 (name dune_rules)
 (libraries stdune fs unix)
 (synopsis "Internal Dune library, do not use!")
 (instrumentation
  (backend bisect_ppx)))

---

(source_file
  (sexp
    (list
      (sexp
        (atom))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (atom))))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (atom))
          (sexp
            (atom))
          (sexp
            (atom))))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (atom))
          (sexp
            (atom))
          (sexp
            (atom))
          (sexp
            (atom))
          (sexp
            (atom))
          (sexp
            (atom))))
      (sexp
        (list
          (sexp
            (atom))
          (sexp
            (list
              (sexp
                (atom))
              (sexp
                (atom)))))))))
